<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Connect Supabase - WellnessHub</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-2xl">
        <div class="bg-white rounded-lg shadow-lg p-8">
            <div class="text-center mb-8">
                <h1 class="text-3xl font-bold text-gray-900 mb-2">ğŸ”— Connect Your Supabase</h1>
                <p class="text-gray-600">Link your WellnessHub app to your Supabase database</p>
            </div>

            <!-- Step Instructions -->
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                <h3 class="font-semibold text-blue-900 mb-2">ğŸ“‹ Where to Find Your Credentials:</h3>
                <ol class="text-sm text-blue-800 space-y-1">
                    <li>1. Go to your Supabase project dashboard</li>
                    <li>2. Click <strong>"Settings"</strong> â†’ <strong>"API"</strong> in the left sidebar</li>
                    <li>3. Copy the values below from that page</li>
                </ol>
            </div>

            <!-- Credentials Form -->
            <form id="credentials-form" class="space-y-6">
                <div>
                    <label for="supabase-url" class="block text-sm font-medium text-gray-700 mb-2">
                        Project URL
                    </label>
                    <input 
                        type="url" 
                        id="supabase-url" 
                        placeholder="https://your-project-id.supabase.co"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                        required
                    >
                    <p class="text-xs text-gray-500 mt-1">Found under "Project URL" in Settings â†’ API</p>
                </div>

                <div>
                    <label for="supabase-key" class="block text-sm font-medium text-gray-700 mb-2">
                        Anon/Public Key
                    </label>
                    <textarea 
                        id="supabase-key" 
                        placeholder="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                        rows="3"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-xs"
                        required
                    ></textarea>
                    <p class="text-xs text-gray-500 mt-1">Found under "anon public" key in Settings â†’ API</p>
                </div>

                <button 
                    type="submit" 
                    class="w-full bg-blue-600 text-white py-3 px-4 rounded-md font-medium hover:bg-blue-700 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500"
                >
                    ğŸ”— Generate Environment File
                </button>
            </form>

            <!-- Generated Output -->
            <div id="output-section" class="hidden mt-8">
                <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-4">
                    <h3 class="font-semibold text-green-900 mb-2">âœ… Environment File Generated!</h3>
                    <p class="text-sm text-green-800">Copy the content below and save it to your <code>.env</code> file</p>
                </div>

                <div class="relative">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        Updated .env file content:
                    </label>
                    <textarea 
                        id="env-output" 
                        class="w-full h-64 p-3 border border-gray-300 rounded-md font-mono text-xs bg-gray-50"
                        readonly
                    ></textarea>
                    <button 
                        type="button" 
                        onclick="copyToClipboard()" 
                        class="absolute top-8 right-2 bg-blue-500 text-white px-3 py-1 rounded text-xs hover:bg-blue-600"
                    >
                        ğŸ“‹ Copy All
                    </button>
                </div>

                <div class="mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                    <h4 class="font-medium text-yellow-900 mb-2">ğŸ“ Next Steps:</h4>
                    <ol class="text-sm text-yellow-800 space-y-1">
                        <li>1. Save the above content to your <code>/Users/ang/Desktop/MVP /.env</code> file</li>
                        <li>2. Run the database schema (if you haven't already)</li>
                        <li>3. Restart your development server: <code>npm run dev</code></li>
                        <li>4. Your app will now connect to your Supabase database!</li>
                    </ol>
                </div>

                <div class="mt-4 text-center">
                    <button 
                        onclick="downloadEnvFile()" 
                        class="bg-green-600 text-white px-6 py-2 rounded-md font-medium hover:bg-green-700 mr-4"
                    >
                        ğŸ’¾ Download .env File
                    </button>
                    <button 
                        onclick="openDatabaseSetup()" 
                        class="bg-purple-600 text-white px-6 py-2 rounded-md font-medium hover:bg-purple-700"
                    >
                        ğŸ—„ï¸ Set Up Database Schema
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.getElementById('credentials-form').addEventListener('submit', function(e) {
            e.preventDefault();
            generateEnvFile();
        });

        function generateEnvFile() {
            const supabaseUrl = document.getElementById('supabase-url').value.trim();
            const supabaseKey = document.getElementById('supabase-key').value.trim();

            if (!supabaseUrl || !supabaseKey) {
                alert('Please fill in both fields!');
                return;
            }

            // Validate URL format
            if (!supabaseUrl.includes('supabase.co')) {
                alert('Please enter a valid Supabase URL (should contain "supabase.co")');
                return;
            }

            // Validate key format (basic JWT check)
            if (!supabaseKey.startsWith('eyJ')) {
                alert('Please enter a valid Supabase key (should start with "eyJ")');
                return;
            }

            const envContent = `# Development Environment Variables
# Replace these with your actual values for production

# Supabase Configuration - CONNECTED âœ…
VITE_SUPABASE_URL=${supabaseUrl}
VITE_SUPABASE_ANON_KEY=${supabaseKey}

# Firebase Configuration (add these when you set up Firebase)
VITE_FIREBASE_API_KEY=demo-api-key
VITE_FIREBASE_AUTH_DOMAIN=demo-project.firebaseapp.com
VITE_FIREBASE_PROJECT_ID=demo-project
VITE_FIREBASE_STORAGE_BUCKET=demo-project.appspot.com
VITE_FIREBASE_MESSAGING_SENDER_ID=123456789
VITE_FIREBASE_APP_ID=1:123456789:web:demo
VITE_FIREBASE_MEASUREMENT_ID=G-DEMO
VITE_FIREBASE_VAPID_KEY=demo-vapid-key

# App Configuration
VITE_APP_NAME="WellnessHub"
VITE_APP_URL=http://localhost:5173`;

            document.getElementById('env-output').value = envContent;
            document.getElementById('output-section').classList.remove('hidden');
            
            // Store for download
            window.generatedEnv = envContent;
        }

        function copyToClipboard() {
            const textarea = document.getElementById('env-output');
            textarea.select();
            document.execCommand('copy');
            
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = 'âœ… Copied!';
            button.style.backgroundColor = '#10b981';
            
            setTimeout(() => {
                button.textContent = originalText;
                button.style.backgroundColor = '';
            }, 2000);
        }

        function downloadEnvFile() {
            if (!window.generatedEnv) {
                alert('Please generate the environment file first!');
                return;
            }

            const blob = new Blob([window.generatedEnv], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = '.env';
            document.body.appendChild(a);
            a.click();
            window.URL.revokeObjectURL(url);
            document.body.removeChild(a);
        }

        function openDatabaseSetup() {
            const newWindow = window.open('', '_blank');
            newWindow.document.write(`
                <html>
                    <head><title>Database Schema Setup</title></head>
                    <body style="font-family: Arial, sans-serif; padding: 20px;">
                        <h1>ğŸ—„ï¸ Database Schema Setup</h1>
                        <p><strong>You need to run the database schema to create all the tables.</strong></p>
                        
                        <h3>Steps:</h3>
                        <ol>
                            <li>Go to your Supabase dashboard</li>
                            <li>Click <strong>"SQL Editor"</strong> in the left sidebar</li>
                            <li>Open this file on your computer: <code>/Users/ang/Desktop/MVP /supabase/schema.sql</code></li>
                            <li>Copy ALL the contents (about 200+ lines)</li>
                            <li>Paste it into the Supabase SQL Editor</li>
                            <li>Click <strong>"Run"</strong></li>
                            <li>You should see "Success. No rows returned" âœ…</li>
                        </ol>
                        
                        <p><strong>This creates:</strong> users, classes, bookings, achievements, notifications tables + security policies</p>
                        
                        <div style="background: #f0f9ff; border: 1px solid #0ea5e9; padding: 15px; border-radius: 5px; margin: 20px 0;">
                            <strong>ğŸ’¡ Tip:</strong> If you see any errors, make sure you copied the entire schema.sql file content.
                        </div>
                    </body>
                </html>
            `);
        }
    </script>
</body>
</html>
