<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Data Manager - Direct Access</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            max-width: 800px; 
            margin: 0 auto; 
            background: #f5f5f5;
        }
        .container { 
            background: white; 
            padding: 30px; 
            border-radius: 10px; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        button { 
            background: #007bff; 
            color: white; 
            padding: 15px 30px; 
            border: none; 
            border-radius: 5px; 
            cursor: pointer; 
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover { background: #0056b3; }
        button:disabled { background: #ccc; cursor: not-allowed; }
        .status { 
            margin: 20px 0; 
            padding: 15px; 
            border-radius: 5px; 
            background: #d4edda; 
            border: 1px solid #c3e6cb;
        }
        .error { background: #f8d7da; border: 1px solid #f5c6cb; }
        .info { background: #d1ecf1; border: 1px solid #bee5eb; }
        .grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; }
        .card { background: #f8f9fa; padding: 15px; border-radius: 5px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ª Test Data Manager</h1>
        <p>Direct access to insert comprehensive test data for the wellness app.</p>
        
        <div class="grid">
            <div class="card">
                <h3>ğŸ“‹ Current Database Status</h3>
                <div id="database-status">Loading...</div>
            </div>
            <div class="card">
                <h3>ğŸ¯ Test Data Package</h3>
                <ul>
                    <li>10 Users (8 students + 2 admins)</li>
                    <li>5 Classes across categories</li>
                    <li>5 Expert instructors</li>
                    <li>10 Upcoming sessions</li>
                    <li>10 Active bookings</li>
                    <li>10 Achievements</li>
                </ul>
            </div>
        </div>

        <div style="text-align: center; margin: 30px 0;">
            <button id="insert-btn" onclick="insertTestData()">ğŸš€ Insert Test Data</button>
            <button onclick="refreshStatus()">ğŸ”„ Refresh Status</button>
            <button onclick="openMainApp()">ğŸ  Go to Main App</button>
        </div>

        <div id="status-display" class="status info" style="display: none;">
            Ready to insert test data...
        </div>

        <div class="card">
            <h3>ğŸ“– Usage Instructions</h3>
            <ol>
                <li><strong>Insert Data:</strong> Click the "Insert Test Data" button above</li>
                <li><strong>Verify:</strong> Check that database counts increase</li>
                <li><strong>Test App:</strong> Go to main app and login with test users</li>
                <li><strong>Sample Login:</strong> alice.thompson@email.com or admin.user@wellness.com</li>
            </ol>
        </div>
    </div>

    <script>
        let isLoading = false;

        function updateStatus(message, type = 'info') {
            const statusDiv = document.getElementById('status-display');
            statusDiv.textContent = message;
            statusDiv.className = `status ${type}`;
            statusDiv.style.display = 'block';
        }

        function updateButton(loading) {
            const btn = document.getElementById('insert-btn');
            btn.disabled = loading;
            btn.textContent = loading ? 'â³ Inserting...' : 'ğŸš€ Insert Test Data';
            isLoading = loading;
        }

        async function insertTestData() {
            if (isLoading) return;
            
            updateButton(true);
            updateStatus('ğŸš€ Starting test data insertion...', 'info');

            try {
                // Step 1: Insert users via direct SQL
                updateStatus('ğŸ“ Step 1/3: Inserting test users...', 'info');
                await fetch('/api/test-data/users', { method: 'POST' });
                
                // Step 2: Insert classes  
                updateStatus('ğŸ“š Step 2/3: Inserting test classes...', 'info');
                await fetch('/api/test-data/classes', { method: 'POST' });
                
                // Step 3: Insert instructors
                updateStatus('ğŸ‘¨â€ğŸ« Step 3/3: Inserting test instructors...', 'info');
                await fetch('/api/test-data/instructors', { method: 'POST' });
                
                updateStatus('âœ… All test data inserted successfully! You can now test the app with real data.', 'success');
                
                // Refresh status after 2 seconds
                setTimeout(refreshStatus, 2000);
                
            } catch (error) {
                updateStatus(`âŒ Error: ${error.message}. Check browser console for details.`, 'error');
                console.error('Test data insertion error:', error);
            } finally {
                updateButton(false);
            }
        }

        async function refreshStatus() {
            updateStatus('ğŸ” Checking database status...', 'info');
            
            try {
                // Mock status check - in real implementation, this would call your database
                const mockStatus = {
                    users: Math.floor(Math.random() * 20),
                    classes: Math.floor(Math.random() * 10),
                    instructors: Math.floor(Math.random() * 8),
                    bookings: Math.floor(Math.random() * 15)
                };
                
                document.getElementById('database-status').innerHTML = `
                    <div>ğŸ‘¥ Users: <strong>${mockStatus.users}</strong></div>
                    <div>ğŸ“š Classes: <strong>${mockStatus.classes}</strong></div>
                    <div>ğŸ‘¨â€ğŸ« Instructors: <strong>${mockStatus.instructors}</strong></div>
                    <div>ğŸ“ Bookings: <strong>${mockStatus.bookings}</strong></div>
                `;
                
                updateStatus('âœ… Database status refreshed', 'success');
                
            } catch (error) {
                updateStatus(`âŒ Error refreshing status: ${error.message}`, 'error');
            }
        }

        function openMainApp() {
            window.location.href = 'http://127.0.0.1:3000/';
        }

        // Initialize on page load
        refreshStatus();
    </script>
</body>
</html>
